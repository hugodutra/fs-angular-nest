<p-dialog
  header="Add User"
  [(visible)]="visible"
  [modal]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '520px' }"
  appendTo="body"
  data-testid="add-user-dialog"
  (onHide)="handleCancel()"
>
  <form class="form" [formGroup]="form" (ngSubmit)="handleSubmit()">
    <div class="grid">
      <div class="field">
        <label for="firstName">First name</label>
        <input
          pInputText
          id="firstName"
          formControlName="firstName"
          autocomplete="off"
          data-testid="add-user-firstName"
        />
      </div>
      <div class="field">
        <label for="lastName">Last name</label>
        <input
          pInputText
          id="lastName"
          formControlName="lastName"
          autocomplete="off"
          data-testid="add-user-lastName"
        />
      </div>
    </div>

    <div class="field">
      <label for="email">Email</label>
      <input
        pInputText
        id="email"
        formControlName="email"
        autocomplete="off"
        data-testid="add-user-email"
      />
    </div>

    <div class="grid">
      <div class="field">
        <label for="role">Role</label>
        <select
          id="role"
          class="p-inputtext"
          formControlName="role"
          data-testid="add-user-role"
        >
          @for (opt of roleOptions; track opt.value) {
          <option [value]="opt.value">{{ opt.label }}</option>
          }
        </select>
      </div>
      <div class="field">
        <label for="password">Password</label>
        <p-password
          inputId="password"
          formControlName="password"
          [feedback]="false"
          toggleMask="true"
          data-testid="add-user-password"
        ></p-password>
      </div>
    </div>

    <div class="field">
      <label for="jobTitle">Job title</label>
      <input
        pInputText
        id="jobTitle"
        formControlName="jobTitle"
        autocomplete="off"
        data-testid="add-user-jobTitle"
      />
    </div>

    <div class="field">
      <label for="bio">Bio</label>
      <textarea
        id="bio"
        formControlName="bio"
        rows="3"
        data-testid="add-user-bio"
      ></textarea>
    </div>

    <div class="field checkbox">
      <p-checkbox
        inputId="isActive"
        formControlName="isActive"
        binary="true"
        data-testid="add-user-isActive"
      ></p-checkbox>
      <label for="isActive">Active</label>
    </div>

    @if (error) {
    <p class="error" data-testid="add-user-error">{{ error }}</p>
    }

    <div class="actions">
      <button
        pButton
        type="button"
        label="Cancel"
        class="p-button-secondary"
        (click)="handleCancel()"
      ></button>
      <button
        pButton
        type="submit"
        label="Create"
        icon="pi pi-check"
        [disabled]="loading"
        [loading]="loading"
        data-testid="add-user-submit"
      ></button>
    </div>
  </form>
</p-dialog>
